<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapéu Seletor - Escola de Magia</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Uncial+Antiqua&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Cinzel', serif;
            background: linear-gradient(45deg, #1a1a2e, #16213e, #0f3460, #1a1a2e);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
            background-attachment: fixed;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .stars {
            position: fixed;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }
        
        .container {
            text-align: center;
            position: relative;
            z-index: 10;
            width: 100%;
            max-width: 480px;
            margin: 0 auto;
            padding-bottom: 40px;
        }
        
        .title {
            font-family: 'Uncial Antiqua', cursive;
            font-size: 2.5rem;
            color: #ffd700;
            margin: 20px 0 30px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            animation: titleGlow 2s ease-in-out infinite alternate;
        }
        
        @media (max-width: 480px) {
            .title {
                font-size: 2rem;
            }
        }
        
        @keyframes titleGlow {
            from { text-shadow: 2px 2px 4px rgba(0,0,0,0.5), 0 0 20px rgba(255,215,0,0.3); }
            to { text-shadow: 2px 2px 4px rgba(0,0,0,0.5), 0 0 30px rgba(255,215,0,0.6); }
        }
        
        .hat-container {
            position: relative;
            display: inline-block;
            margin: 40px 0 60px 0;
        }
        
        .sorting-hat {
            width: 200px;
            height: auto;
            cursor: pointer;
            transition: all 0.3s ease;
            filter: drop-shadow(0 10px 20px rgba(0,0,0,0.3));
        }
        
        @media (max-width: 480px) {
            .sorting-hat {
                width: 160px;
            }
        }
        
        .sorting-hat:hover {
            transform: scale(1.05);
            filter: drop-shadow(0 15px 30px rgba(0,0,0,0.5));
        }
        
        .thinking-bubble {
            position: absolute;
            top: -70px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.9);
            padding: 12px 20px;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: 600;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            white-space: nowrap;
            min-width: 100px;
            z-index: 20;
        }
        
        @media (max-width: 480px) {
            .thinking-bubble {
                font-size: 0.9rem;
                padding: 10px 16px;
                top: -60px;
            }
        }
        
        .thinking-bubble::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid rgba(255,255,255,0.9);
        }
        
        .result-container {
            opacity: 0;
            transform: translateY(50px);
            transition: all 0.8s ease;
            margin-top: 40px;
            padding: 20px;
            border-radius: 15px;
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
        }
        
        .result-container.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .house-image {
            width: 280px;
            height: auto;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            margin: 20px 0;
        }
        
        @media (max-width: 480px) {
            .house-image {
                width: 240px;
            }
        }
        
        .house-name {
            font-family: 'Uncial Antiqua', cursive;
            font-size: 2.2rem;
            font-weight: 700;
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        @media (max-width: 480px) {
            .house-name {
                font-size: 1.8rem;
            }
        }
        
        .house-description {
            font-size: 1.1rem;
            max-width: 400px;
            margin: 0 auto 20px;
            line-height: 1.6;
            opacity: 0.9;
            color: #f0f0f0;
        }
        
        @media (max-width: 480px) {
            .house-description {
                font-size: 1rem;
                padding: 0 10px;
            }
        }
        
        .house-stats {
            font-size: 0.9rem;
            margin-top: 20px;
            opacity: 0.8;
            color: #cccccc;
        }
        
        .reset-btn {
            background: linear-gradient(45deg, #4a4a4a, #666666);
            color: white;
            border: none;
            padding: 15px 35px;
            font-size: 1.1rem;
            font-family: 'Cinzel', serif;
            border-radius: 25px;
            cursor: pointer;
            margin-top: 25px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            min-height: 50px;
        }
        
        @media (max-width: 480px) {
            .reset-btn {
                padding: 12px 30px;
                font-size: 1rem;
                margin-top: 20px;
            }
        }
        
        .reset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            background: linear-gradient(45deg, #555555, #777777);
        }
        
        /* Cores específicas das casas */
        .aqualis { color: #4a90e2; text-shadow: 2px 2px 4px rgba(0,0,0,0.5), 0 0 20px rgba(74,144,226,0.5); }
        .ignavia { color: #e74c3c; text-shadow: 2px 2px 4px rgba(0,0,0,0.5), 0 0 20px rgba(231,76,60,0.5); }
        .silvarum { color: #27ae60; text-shadow: 2px 2px 4px rgba(0,0,0,0.5), 0 0 20px rgba(39,174,96,0.5); }
        .venturia { color: #87ceeb; text-shadow: 2px 2px 4px rgba(0,0,0,0.5), 0 0 20px rgba(135,206,235,0.5); }
        .animaris { color: #9b59b6; text-shadow: 2px 2px 4px rgba(0,0,0,0.5), 0 0 20px rgba(155,89,182,0.5); }
        
        /* Animações específicas */
        @keyframes hatShake {
            0%, 100% { transform: rotate(0deg) scale(1); }
            25% { transform: rotate(-5deg) scale(1.05); }
            50% { transform: rotate(5deg) scale(1.1); }
            75% { transform: rotate(-3deg) scale(1.05); }
        }
        
        @keyframes hatThinking {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .hat-shaking {
            animation: hatShake 0.8s ease-in-out 3;
        }
        
        .hat-thinking {
            animation: hatThinking 1.5s ease-in-out infinite;
        }
        
        .magic-particles {
            position: absolute;
            pointer-events: none;
        }
        
        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #ffd700;
            border-radius: 50%;
            animation: particleFloat 2s ease-out forwards;
        }
        
        @keyframes particleFloat {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) scale(0.5);
            }
        }
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>
    
    <div class="container">
        <h1 class="title">Chapéu Seletor</h1>
        
        <div class="hat-container">
            <div class="thinking-bubble" id="thinkingBubble"></div>
            <img src="./images/chapeu-seletor.png" alt="Chapéu Seletor" class="sorting-hat" id="sortingHat">
        </div>
        
        <div class="result-container" id="resultContainer">
            <img src="" alt="" class="house-image" id="houseImage">
            <h2 class="house-name" id="houseName"></h2>
            <p class="house-description" id="houseDescription"></p>
            <div class="house-stats" id="houseStats"></div>
            <button class="reset-btn" onclick="resetSelection()">Sortear Novamente</button>
        </div>
    </div>

    <script>
        // Dados das casas
        const houses = {
            aqualis: {
                name: "Casa Aqualis",
                element: "Água",
                characteristics: "Intuição, empatia, adaptabilidade e serenidade",
                animal: "Serpente-Marinha",
                colors: ["azul", "prata"],
                image: "./images/casa-aqualis.png",
                class: "aqualis",
                count: 0
            },
            ignavia: {
                name: "Casa Ignavia", 
                element: "Fogo",
                characteristics: "Coragem, paixão, determinação e energia criativa",
                animal: "Fênix",
                colors: ["vermelho", "dourado"],
                image: "./images/casa-ignavia.png",
                class: "ignavia",
                count: 0
            },
            silvarum: {
                name: "Casa Silvarum",
                element: "Terra", 
                characteristics: "Força, estabilidade, lealdade e resiliência",
                animal: "Urso",
                colors: ["verde", "marrom"],
                image: "./images/casa-silvarum.png",
                class: "silvarum",
                count: 0
            },
            venturia: {
                name: "Casa Venturia",
                element: "Vento",
                characteristics: "Liberdade, inteligência, criatividade e espírito aventureiro", 
                animal: "Grifo",
                colors: ["branco", "azul claro"],
                image: "./images/casa-venturia.png",
                class: "venturia",
                count: 0
            },
            animaris: {
                name: "Casa Animaris",
                element: "Alma",
                characteristics: "Sabedoria, espiritualidade, equilíbrio e conexão com o invisível",
                animal: "Lobo",
                colors: ["roxo", "preto"],
                image: "./images/casa-animaris.png", 
                class: "animaris",
                count: 0
            }
        };

        // Mensagens de pensamento do chapéu
        const thinkingMessages = [
            "Hmm...",
            "Interessante...", 
            "Deixe-me ver...",
            "Qual será?",
            "Pensando...",
            "Ah, sim...",
            "Muito curioso...",
            "Quase lá...",
            "Posso sentir..."
        ];

        let isSelecting = false;

        // Criar estrelas no fundo
        function createStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = Math.random() * 3 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }

        // Função para seleção equilibrada
        function getBalancedHouse() {
            const houseKeys = Object.keys(houses);
            const minCount = Math.min(...houseKeys.map(key => houses[key].count));
            const availableHouses = houseKeys.filter(key => houses[key].count === minCount);
            return availableHouses[Math.floor(Math.random() * availableHouses.length)];
        }

        // Criar partículas mágicas
        function createMagicParticles() {
            const container = document.querySelector('.hat-container');
            for (let i = 0; i < 15; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = Math.random() * 200 + 'px';
                    particle.style.top = Math.random() * 200 + 'px';
                    container.appendChild(particle);
                    
                    setTimeout(() => {
                        if (particle.parentNode) {
                            particle.parentNode.removeChild(particle);
                        }
                    }, 2000);
                }, i * 100);
            }
        }

        // Função principal de seleção
        async function selectHouse() {
            if (isSelecting) return;
            
            isSelecting = true;
            const hat = document.getElementById('sortingHat');
            const bubble = document.getElementById('thinkingBubble');
            const resultContainer = document.getElementById('resultContainer');
            
            // Esconder resultado anterior
            resultContainer.classList.remove('show');
            
            // Animação inicial do chapéu
            hat.classList.add('hat-shaking');
            createMagicParticles();
            
            // Mostrar mensagens de pensamento
            for (let i = 0; i < 6; i++) {
                setTimeout(() => {
                    const message = thinkingMessages[Math.floor(Math.random() * thinkingMessages.length)];
                    bubble.textContent = message;
                    bubble.style.opacity = '1';
                    
                    setTimeout(() => {
                        bubble.style.opacity = '0';
                    }, 800);
                }, i * 1000);
            }
            
            // Depois de 3 segundos, parar de balançar e começar a "pensar"
            setTimeout(() => {
                hat.classList.remove('hat-shaking');
                hat.classList.add('hat-thinking');
            }, 3000);
            
            // Após 6 segundos, revelar o resultado
            setTimeout(() => {
                hat.classList.remove('hat-thinking');
                bubble.style.opacity = '0';
                
                // Selecionar casa equilibrada
                const selectedHouseKey = getBalancedHouse();
                const selectedHouse = houses[selectedHouseKey];
                selectedHouse.count++;
                
                // Mostrar resultado
                showResult(selectedHouse);
                
                setTimeout(() => {
                    isSelecting = false;
                }, 1000);
            }, 6000);
        }

        // Mostrar resultado
        function showResult(house) {
            const resultContainer = document.getElementById('resultContainer');
            const houseImage = document.getElementById('houseImage');
            const houseName = document.getElementById('houseName');
            const houseDescription = document.getElementById('houseDescription');
            const houseStats = document.getElementById('houseStats');
            
            houseImage.src = house.image;
            houseImage.alt = house.name;
            
            houseName.textContent = house.name;
            houseName.className = 'house-name ' + house.class;
            
            houseDescription.innerHTML = `
                <strong>Elemento:</strong> ${house.element}<br>
                <strong>Características:</strong> ${house.characteristics}<br>
                <strong>Animal Totêmico:</strong> ${house.animal}
            `;
            
            const totalSorted = Object.values(houses).reduce((sum, h) => sum + h.count, 0);
            houseStats.innerHTML = `Membros selecionados: ${house.count} | Total de seleções: ${totalSorted}`;
            
            resultContainer.classList.add('show');
            
            // Rolar suavemente para o resultado após um pequeno delay
            setTimeout(() => {
                scrollToResult();
            }, 500);
        }

        // Função para rolar suavemente até o resultado
        function scrollToResult() {
            const resultContainer = document.getElementById('resultContainer');
            const containerTop = resultContainer.offsetTop;
            const windowHeight = window.innerHeight;
            const containerHeight = resultContainer.offsetHeight;
            
            // Calcular posição ideal para centralizar o resultado na tela
            const targetPosition = containerTop - (windowHeight - containerHeight) / 2;
            
            window.scrollTo({
                top: Math.max(0, targetPosition),
                behavior: 'smooth'
            });
        }
        // Reset da seleção
        function resetSelection() {
            const resultContainer = document.getElementById('resultContainer');
            resultContainer.classList.remove('show');
            
            // Rolar suavemente de volta ao topo
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // Event listeners
        document.getElementById('sortingHat').addEventListener('click', selectHouse);
        
        // Inicializar
        createStars();
        
        // Preload de imagens (fallback para quando as imagens não existirem)
        const imageNames = ['chapeu-seletor.png', 'casa-aqualis.png', 'casa-ignavia.png', 'casa-silvarum.png', 'casa-venturia.png', 'casa-animaris.png'];
        imageNames.forEach(imageName => {
            const img = new Image();
            img.src = './images/' + imageName;
            img.onerror = function() {
                // Se a imagem não carregar, usar um placeholder ou emoji
                if (imageName === 'chapeu-seletor.png') {
                    document.getElementById('sortingHat').style.fontSize = '150px';
                    document.getElementById('sortingHat').innerHTML = '🎩';
                    document.getElementById('sortingHat').style.width = 'auto';
                    document.getElementById('sortingHat').style.height = 'auto';
                }
            };
        });
    </script>
</body>
</html>